---
date: 2024-09-09T19:03:22.055623
author: AutoGPT <info@agpt.co>
---

# video api

To develop an API that serves a video based on a simple authorization system using the specified tech stack (Python, FastAPI, PostgreSQL, and Prisma), a clear plan of action has been established from the gathered information. The system encompasses a simplistic yet secure authorization mechanism catering directly to a singular user role setup, negating the need for public video access without authorization. 

Key implementation steps derived from the responses and research include:

1. **Authorization Mechanism**: Implementing a basic authorization system within FastAPI, utilizing OAuth2 with Password and Bearer with JWT tokens for secure user authentication. This setup will ensure that only authorized users can access the video content.

2. **User Management**: Leveraging PostgreSQL managed through Prisma ORM to create a users table that will store user credentials securely. This step includes handling user authentication and role-based access control mechanisms.

3. **Secure Video Serving**: Ensuring video content is served over HTTPS to encrypt data transmission and considering the use of signed URLs for each video content. This approach will help in preventing unauthorized access and sharing of the video content.

4. **Security Practices**: Employing best practices in securing the API, including the management of sensitive information through environment variables or secret management tools, updating dependencies regularly to mitigate vulnerabilities, and creating comprehensive tests covering authentication and authorization logic.

5. **Simple Client-Server Communication**: The system will allow for a randomized header, easily generated by the client alongside the server, thus facilitating a simple yet secure method for accessing videos.

The collected inputs and researched data have significantly contributed to forming a comprehensive project plan focused on simplicity, security, and efficiency, aligning with the userâ€™s initial vision.

## What you'll need to run this
* An unzipper (usually shipped with your OS)
* A text editor
* A terminal
* Docker
  > Docker is only needed to run a Postgres database. If you want to connect to your own
  > Postgres instance, you may not have to follow the steps below to the letter.


## How to run 'video api'

1. Unpack the ZIP file containing this package

2. Adjust the values in `.env` as you see fit.

3. Open a terminal in the folder containing this README and run the following commands:

    1. `poetry install` - install dependencies for the app

    2. `docker-compose up -d` - start the postgres database

    3. `prisma generate` - generate the database client for the app

    4. `prisma db push` - set up the database schema, creating the necessary tables etc.

4. Run `uvicorn project.server:app --reload` to start the app

## How to deploy on your own GCP account
1. Set up a GCP account
2. Create secrets: GCP_EMAIL (service account email), GCP_CREDENTIALS (service account key), GCP_PROJECT, GCP_APPLICATION (app name)
3. Ensure service account has following permissions: 
    Cloud Build Editor
    Cloud Build Service Account
    Cloud Run Developer
    Service Account User
    Service Usage Consumer
    Storage Object Viewer
4. Remove on: workflow, uncomment on: push (lines 2-6)
5. Push to master branch to trigger workflow
